
<div class="page-content">
  <div class="container-fluid">

    <!-- start page title -->
    <div class="row">
      <div class="col-12">
        <div class="page-title-box d-flex align-items-center justify-content-between">
          <div class="page-title-right d-flex">
            <a class="back-button mr-3" (click)="goBack()">
              <img src="assets/images/icons/back-icon.svg">
            </a>
            <ol class="breadcrumb m-0">
              <li class="breadcrumb-item active">
                <a [routerLink]="['/admin/categories']">
                  {{'categories.superCategories' | translate}}
                </a>
              </li>
              <li class="breadcrumb-item">
                {{'categories.categories' | translate}}
              </li>
            </ol>
          </div>
          <div class="page-title-right2">
            <input type="file" name="filePrices" id="filePrices" (change)="onFileSelected($event)"
              style="display: none;" #fileInput
              accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
            <button type="button" class="btn btn-rounded btn-warning btn-w waves-effect waves-light"
              (click)="fileInput.click()">
              {{'labels.uploadPrices' | translate}}
            </button>
            <button type="button" class="btn btn-rounded btn-warning btn-w waves-effect waves-light"
              (click)="getCategoriesToBeReordered()" data-toggle="modal" data-target=".changeOrder_detail">
              {{'labels.changeOrder' | translate}}</button>
            <button type="button" class="btn btn-rounded btn-warning btn-w waves-effect waves-light" data-toggle="modal"
              data-target=".add_detail">
              {{'categories.add' | translate}}
            </button>

            <!-- ADD CATEGORY MODAL -->
            <div class="modal fade add_detail" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
              aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title mt-0">{{'categories.addCategory' | translate}}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <form [formGroup]="categoryForm">
                      <div class="row">
                        <div class="col-lg-12">
                          <div class="form-group">
                            <label class="control-label">
                              {{'categories.uploadPicture' | translate}}
                            </label>
                            <div class="custom_file">
                              <input type="file" class="custom_file_input" accept="image/*"
                                (change)="onSelectFile($event)" formControlName="category_icon">
                            </div>
                          </div>
                        </div>
                        <div class="col-lg-12">
                          <div class="form-group">
                            <label class="control-label">{{'categories.name' | translate}}</label>
                            <input type="text" class="form-control" name="course-name" placeholder="Enter English"
                              formControlName="category_name_en">
                          </div>
                          <div class="form-group">
                            <!-- <label for="validationCustom01">{{'labels.arabicName' | translate}}</label> -->
                            <input type="text" minlength="3" placeholder="Enter Arabic"
                              formControlName="category_name_ar" class="form-control">
                          </div>
                          <div class="form-group">
                            <label class="control-label">{{'categories.categoryMaxPrice' | translate}}</label>
                            <input type="text" maxlength="3" class="form-control" name="course-name"
                              [placeholder]="'categories.categoryMaxPrice' | translate" formControlName="max_percentage"
                              (keypress)="numberOnly($event)">
                          </div>
                        </div>

                      </div>
                      <button class="btn btn-warning" type="submit" data-dismiss="modal" (click)="saveCategory()"
                        [disabled]="!categoryForm.valid">
                        {{'categories.save' | translate}}
                      </button>
                    </form>
                  </div>
                </div><!-- /.modal-content -->
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
            <!-- END: ADD CATEGORY MODAL -->

          </div>
        </div>
      </div>
    </div>
    <!-- end page title -->

    <div class="row">
      <div class="col-lg-12">
        <div class="card">
          <div class="card-body pt-3">
            <div class="table-responsive table-style">
              <!-- <div class="row">
                <div class="col-sm-12 col-md-6"></div>
                <div class="col-sm-12 col-md-6 ">
                  <div class="dataTables_filter"><label>
                    {{'search' | translate}}
                    <input type="search" class="form-control form-control-sm" >
                  </label>
                  </div>
                </div>
              </div> -->
              <table class="table mb-0">
                <thead class="thead-light">
                  <tr>
                    <th style="width: 20px;">{{'administrators.no' | translate}}</th>
                    <th style="width: 80px;">{{'administrators.picture' | translate}}</th>
                    <th>{{'administrators.name' | translate}}</th>
                    <th>{{'administrators.maxPercentage' | translate}}</th>
                    <th style="width: 120px;">{{'administrators.action' | translate}}</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- shgsghd -->
                  <tr *ngFor="let data of categoryList; let i=index">
                    <td data-title="{{'administrators.no' | translate}}">{{i+1}}</td>
                    <td data-title="{{'administrators.picture' | translate}}"><img [src]="data?.category_icon" alt=""
                        height="30" class="img"></td>
                    <td data-title="{{'administrators.name' | translate}}">
                      {{data?.category_name}}<br>
                      {{'('+data?.category_name_ar+')'}}
                    </td>
                    <td data-title="{{'administrators.maxPercentage' | translate}}">{{data?.max_percentage}}</td>
                    <td data-title="{{'administrators.action' | translate}}">
                      <a [routerLink]="['/admin/categories/brands',data?._id]" class="mr-2 text-solitud">
                        <i class="fas fa-eye font-size-18"></i>
                      </a>
                      <button type="button" class="mr-2 text-primary btn_style" data-toggle="modal"
                        data-target=".edit_detail">
                        <i class="mdi mdi-pencil font-size-18" (click)="updateCategory(data)"></i>
                      </button>

                      <a class="text-danger" (click)="action(data?._id)">
                        <i class="mdi mdi-trash-can font-size-18"></i>
                      </a>
                    </td>
                  </tr>
                  <tr *ngIf="!categoryList?.length">
                    <td colspan="4">No Categories found!</td>
                  </tr>
                </tbody>
              </table>

              <!-- PAGINATION -->
              <!-- <div class="row">
                <div class="col-sm-12 col-md-5">
                  <div class="dataTables_info">Showing 1 to 50 of 51 entries</div>
                </div>
                <div class="col-sm-12 col-md-7">
                  <div class="dataTables_paginate paging_simple_numbers">
                    <ul class="pagination pagination-rounded">
                      <li class="paginate_button page-item previous disabled"><a href="#" class="page-link"><i
                            class="mdi mdi-chevron-left"></i></a></li>
                      <li class="paginate_button page-item active"><a href="#" class="page-link">1</a></li>
                      <li class="paginate_button page-item "><a href="#" class="page-link">2</a></li>
                      <li class="paginate_button page-item next"><a href="#" class="page-link"><i
                            class="mdi mdi-chevron-right"></i></a></li>
                    </ul>
                  </div>
                </div>
              </div> -->
              <!-- END: PAGINATION -->

              <!-- EDIT CATEGORY MODAL -->
              <div class="modal fade edit_detail" id="edit-category" tabindex="-1" role="dialog"
                aria-labelledby="mySmallModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title mt-0">{{'categories.editCategory' | translate}}</h5>
                      <button type="button" class="close" (click)="closeModal('edit-category')">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <form [formGroup]="updateCategoryForm">
                        <div class="row">
                          <div class="col-lg-12">
                            <div class="form-group">
                              <label class="control-label">{{'categories.uploadPicture' | translate}}</label>
                              <div class="custom_file">
                                <input type="file" (change)="onSelectFile($event)" class="custom_file_input"
                                  accept="image/*" formControlName="category_icon">
                              </div>
                            </div>
                          </div>
                          <div class="col-lg-12">
                            <div class="form-group">
                              <label class="control-label">{{'categories.name' | translate}}</label>
                              <input type="text" class="form-control" placeholder="Enter English" name="course-name"
                                formControlName="category_name_en">
                            </div>
                            <div class="form-group">
                              <!-- <label for="validationCustom01">{{'labels.arabicName' | translate}}</label> -->
                              <input type="text" minlength="3" placeholder="Enter Arabic"
                                formControlName="category_name_ar" class="form-control">
                            </div>
                            <div class="form-group">
                              <label class="control-label">{{'categories.categoryMaxPrice' | translate}}</label>
                              <input type="text" maxlength="3" class="form-control" name="course-name"
                                [placeholder]="'categories.categoryMaxPrice' | translate"
                                formControlName="max_percentage" (keypress)="numberOnly($event)">
                            </div>
                          </div>
                        </div>
                        <button class="btn btn-warning" type="submit" data-dismiss="modal" (click)="editCategory()">
                          {{'categories.update' | translate}}
                        </button>
                      </form>
                    </div>
                  </div><!-- /.modal-content -->
                </div><!-- /.modal-dialog -->
              </div><!-- /.modal -->
              <!-- END: EDIT CATEGORY -->

            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- end row -->

  </div> <!-- container-fluid -->
</div>
<!-- End Page-content -->

<!-- Change Order list -->
<div class="modal fade changeOrder_detail" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollables">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title mt-0">Change Categories Order</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">×</span>
        </button>
      </div>
      <div class="modal-body modal-orderList">
        <div #scrollEl cdk-scrollable style="height:400px; overflow-y:auto;">
          <table class="table mb-0">
            <thead class="thead-light">
              <tr>
                <th style="width: 20px;">{{'administrators.no' | translate}}</th>
                <th style="width: 80px;">{{'administrators.picture' | translate}}</th>
                <th>{{'administrators.name' | translate}}</th>
              </tr>
            </thead>
            <tbody class="box-list" cdkDropList cdkDropListOrientation="vertical" (cdkDropListDropped)="drop($event)">
              <tr class="drag-box" *ngFor="let category of categoriesToBeReOrdered; let i = index" cdkDrag>
                <td data-title="{{'administrators.no' | translate}}">{{i+1}}</td>
                <td data-title="{{'administrators.picture' | translate}}"><img [src]="category?.category_icon" alt=""
                    height="30" class="img"></td>
                <td data-title="{{'administrators.name' | translate}}">
                  {{category?.category_name}}<br>
                  {{'('+category?.category_name_ar+')'}}
                </td>
              </tr>
            </tbody>
            <!-- <pre>{{newArr | json}}</pre> -->
          </table>

        </div>
        <button type="submit" class="btn btn-warning" data-dismiss="modal"
          (click)="changeOrderForCategory()">Save</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
