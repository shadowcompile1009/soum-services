<div class="page-content table_page">
  <div class="container-fluid">

    <!-- start page title -->
    <div class="row">
      <div class="col-12">
        <div class="page-title-box d-flex align-items-center justify-content-between">
          <div class="page-title-right">
            <ol class="breadcrumb m-0">
              <li class="breadcrumb-item active">{{'ordersDetails.orderSuccess' | translate}}</li>
            </ol>
          </div>
        </div>
      </div>
    </div>
    <!-- end page title -->

    <div class="row">
      <div class="col-lg-12">
        <div class="card">
          <div class="card-body pt-3">
            <div class="table-responsive table-style">
              <div class="row">

                <div class="col-md-7 col-sm-12 search_part">
                  <form class="dataTables_filter" [formGroup]="searchForm" (ngSubmit)="filterBy()">
                    <label>{{'search' | translate}}
                      <input type="search" class="form-control form-control-sm" formControlName="word"
                        placeholder="Search ..... ">
                      <button type="submit" class="btn btn-danger btn-sm">Search</button>
                    </label>
                  </form>
                </div>

                <div class="col-md-2 col-sm-12">
                </div>

                <div class="col-md-3 col-sm-12 download_xlxs_container">
                  <div *ngIf="orderList?.length != 0" class="d-flex justify-content-end" (click)="downloadOrderXlxs()">
                    <img title="{{'ordersPage.exportAsXlxs' | translate}}" class="xlxs_download"
                      src="../../../../assets/images/xlsx.png" />
                  </div>
                </div>

              </div>
              <table class="table mb-0">
                <thead class="thead-light">
                  <tr>
                    <th>{{'ordersPage.no' | translate}}</th>
                    <th>{{'ordersPage.orderID' | translate}}</th>
                    <th>{{'ordersPage.productId' | translate}}</th>
                    <th>{{'ordersPage.status' | translate}}</th>
                    <th style="min-width: 100px;">{{'ordersPage.date' | translate}}</th>
                    <th>{{'ordersPage.seller_Name' | translate}}</th>
                    <th>{{'ordersPage.seller_Phone' | translate}}</th>
                    <th>{{'ordersPage.sellerCity' | translate}}</th>
                    <th>{{'ordersPage.referralCodeSeller' | translate}}</th>
                    <th>{{'ordersPage.buyerName' | translate}}</th>
                    <th>{{'ordersPage.buyerPhone' | translate}}</th>
                    <th>{{'ordersPage.buyerCity' | translate}}</th>
                    <th>{{'ordersPage.referralCodeBuyer' | translate}}</th>
                    <th>{{'ordersPage.model' | translate}}</th>
                    <th>{{'ordersPage.buyerGrantTotal' | translate}}</th>
                    <th>{{'ordersPage.sellPrice' | translate}}</th>
                    <th >{{'ordersPage.paymentType' | translate}}</th>
                    <th >{{'ordersPage.downPayment' | translate}}</th>
                    <th >{{'ordersPage.codAmt' | translate}}</th>
                    <th >{{'ordersPage.action' | translate}}</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let order of orderList| paginate: {
                    id: 'orderList',
                    itemsPerPage: limit,
                    currentPage: currentPage,
                    totalItems: totalResult
                  }; let i = index;">
                    <td data-title="{{'ordersPage.no' | translate}}">
                      {{ limit * (currentPage - 1) + i + 1 }}
                    </td>
                    <td data-title="{{'ordersPage.orderID' | translate}}">{{order?.order_number || '---'}}</td>
                    <td data-title="{{'ordersPage.productID' | translate}}">{{order?.product?._id || '---'}}</td>
                    <td data-title="{{'ordersPage.trackingStatus' | translate}}">{{order?.transaction_status || '---'}}</td>

                    <td data-title="{{'ordersPage.date' | translate}}">{{order?.created_at | date: 'dd MMM, yyyy' || '---'}}</td>

                    <td data-title="{{'ordersPage.seller_Name' | translate}}">{{order?.seller?.name || '---'}}</td>

                    <td data-title="{{'ordersPage.seller_Phone' | translate}}">{{order?.seller?.mobileNumber || '---'}}</td>

                    <td data-title="{{'ordersPage.sellerCity' | translate}}">{{order?.seller?.city || '---'}}</td>

                    <td data-title="{{'ordersPage.referralCodeSeller' | translate}}">{{order?.seller?.referralCode ? order?.seller?.referralCode : '----'}}</td>

                    <td data-title="{{'ordersPage.buyerName' | translate}}">{{order?.buyer?.name || '---'}}</td>

                    <td data-title="{{'ordersPage.buyerPhone' | translate}}">{{order?.buyer?.mobileNumber || '---'}}</td>

                    <td data-title="{{'ordersPage.buyerCity' | translate}}">{{order?.buyer?.city || '---'}}</td>

                    <td data-title="{{'ordersPage.referralCodeBuyer' | translate}}">{{order?.buyer?.referralCode ? order?.buyer?.referralCode : '----'}}</td>
                    
                    <td data-title="{{'ordersPage.model' | translate}}">{{order?.product?.model_id?.model_name || '---'}}</td>

                    <td data-title="{{'ordersPage.buyerGrantTotal' | translate}}">{{convertNumbers(order?.grand_total) || '---'}} {{currency}}</td>

                    <td data-title="{{'ordersPage.sellPrice' | translate}}">{{order?.buy_amount}} {{currency}}</td>

                    <!-- <td data-title="{{'ordersPage.sellPrice' | translate}}">{{order?.buy_type == "Direct"? order?.product?.sell_price : (order?.product?.bidding?convertNumbers(order?.product?.bidding[order?.product?.bidding?.length - 1]?.bid_price): '---')}}</td> -->
                    <td data-title="{{'ordersPage.paymentType' | translate}}">
                      <span *ngIf="order?.down_payment_details && order?.down_payment_details !== null">
                        {{'ordersPage.downPayment' | translate}} 
                      </span>
                      <span *ngIf="order?.down_payment_details == null">
                        {{'ordersPage.regularPayment' | translate}}
                      </span>
                    </td>
                    <td data-title="{{'ordersPage.downPayment' | translate}}">
                      <span *ngIf="order?.down_payment_details && order?.down_payment_details !== null">
                        {{order?.down_payment_details?.payment_amount}} {{currency}}
                      </span>
                      <span *ngIf="order?.down_payment_details == null">
                        {{order?.grand_total}} {{currency}}                    </span>
                    </td>
                    <td data-title="{{'ordersPage.codAmt' | translate}}">
                      <span *ngIf="order?.down_payment_details && order?.down_payment_details !== null">
                        {{order?.down_payment_details?.remaining}} {{currency}}
                      </span>
                      <span *ngIf="order?.down_payment_details == null">
                       0                    </span>
                    </td>
                    <td data-title="{{'ordersPage.action' | translate}}">
                      <a (click)="viewOrderDetail(order)" class="mr-2 text-solitud"><i
                          class="fas fa-eye font-size-18"></i></a>
                      <a title="payout" (click)="viewOrderPayout(order)" class="mr-2 text-solitud"><i
                          class="fas fa-dollar-sign font-size-18"></i></a>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div class="row" *ngIf="notMatchSearch">
                <div class="col-12 notMatchSearch">
                  <h5>No Found Data Match Your Search!</h5>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-12 col-md-5">
                  <div class="dataTables_info">{{'ordersPage.showMinMaxNumberofList' | translate: entries}}</div>
                </div>
                <div class="col-sm-12 col-md-7" *ngIf="orderList.length>0">
                  <div class="dataTables_paginate paging_simple_numbers">
                    <pagination-controls [autoHide]="true" [nextLabel]="paginationNextLabel"
                      [previousLabel]="paginationPreviousLabel" id="orderList" (pageChange)="selectPage($event)">
                    </pagination-controls>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- end row -->

  </div> <!-- container-fluid -->
</div>
<!-- End Page-content -->
